# PDF Splitter

PDFファイルの目次（ブックマーク/アウトライン）情報を読み取り、章ごとに自動分割してファイル保存するコマンドラインツール（CLI）です。Rustで記述されており、日本語のファイル名やタイトルにも対応しています。

## 特徴

* **目次ベースの分割**: PDFに設定された「しおり（Outline）」に基づいて分割します。
* **日本語対応**: 日本語の章タイトルを正しくデコードし、ファイル名に反映します。
* **高速・軽量**: Rust製のため動作が高速です。
* **非破壊**: 元のPDFファイルを変更せず、分割した新しいファイルを作成します。

## 前提条件

* **Rust (Cargo)** がインストールされていること。
    * まだの場合は [rustup.rs](https://rustup.rs/) からインストールしてください。

## 1. ビルドと実行モジュールの作成

開発用ではなく、実際にツールとして配布・利用するための「最適化された実行ファイル（リリースビルド）」を作成する方法です。

プロジェクトのディレクトリで以下のコマンドを実行してください。

```bash
# 最適化オプション付きでビルド（時間が少しかかりますが、高速に動作するファイルができます）
cargo build --release
```

ビルドが成功すると、以下の場所に実行ファイルが生成されます。

* **macOS / Linux**: `./target/release/pdf_splitter`
* **Windows**: `.\target\release\pdf_splitter.exe`

## 2. パスの通し方（インストール）

このツールをどのディレクトリからでも `pdf_splitter` コマンドだけで呼び出せるようにするには、以下のいずれかの方法を行います。

### 方法A: `cargo install` を使う（推奨）

Rust標準の機能を使って、システム（ユーザー領域）にインストールします。パスの設定も自動（または半自動）で行われるため最も簡単です。

```bash
# プロジェクトのルートディレクトリで実行
cargo install --path .
```

これだけで、`pdf_splitter input.pdf` のようにどこからでも実行できるようになります。
※ `~/.cargo/bin` にパスが通っている必要があります（Rustインストール時に通常は設定されています）。

### 方法B: 手動でパスの通った場所にコピーする

#### macOS / Linux の場合
一般的なコマンド置き場（`/usr/local/bin` など）に生成されたファイルをコピーします。

```bash
# 生成された実行ファイルを /usr/local/bin にコピー（管理者権限が必要）
sudo cp ./target/release/pdf_splitter /usr/local/bin/
```

#### Windows の場合
1. 任意のフォルダ（例: `C:\Tools`）を作成し、そこに `pdf_splitter.exe` をコピーします。
2. Windowsの検索バーで「環境変数を編集」を検索して開きます。
3. 「Path」という変数を選択して「編集」を押し、`C:\Tools` を追加します。

## 3. 使いかた

ターミナル（コマンドプロンプト）を開き、PDFファイルがある場所、またはファイルパスを指定して実行します。

### 開発中の動作確認
```bash
# 同じディレクトリにあるファイルを分割
cargo run -- /Users/name/Documents/research.pdf
```

### 基本的な使い方

```bash
# 同じディレクトリにあるファイルを分割
pdf_splitter input.pdf
```

### 別の場所にあるファイルを指定

```bash
# 絶対パスで指定
pdf_splitter /Users/name/Documents/research.pdf
```

### 実行結果

成功すると、元のファイルと同じディレクトリに以下のようなファイルが生成されます。

* `input_chapter_1_はじめに.pdf`
* `input_chapter_2_技術仕様.pdf`
* `input_chapter_3_結論.pdf`

## トラブルシューティング

* **「目次が見つかりませんでした」と表示される**:
    * 対象のPDFに「しおり（ブックマーク）」が設定されていない可能性があります。PDFビューアで目次が表示されるか確認してください。
* **文字化けする**:
    * 本ツールは UTF-16BE および UTF-8 のエンコーディングに対応していますが、特殊なエンコーディング（Shift_JISなど）が埋め込まれている場合は正しく表示されない場合があります。